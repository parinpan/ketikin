const ketikin=(e,t)=>{t=Object.assign({texts:null,speed:0,loop:!1},t),fenceSpeed=(e=>e=100-(e=(e=e>100?100:e)<0?0:e)),getSeq=(e=>e.getAttribute("ketikin-seq")),getCursor=(e=>e.querySelector("#"+getSeq(e))||document.createElement("cursor")),animateCursor=(e=>{getCursor(e).animate([{opacity:.5}],{duration:1e3,iterations:1/0})}),removeCursor=(e=>{getCursor(e).remove()}),addCursor=(e=>{e.innerHTML=e.innerHTML+'<span id="{id}">|</span>'.replace("{id}",getSeq(e))}),addTypingChar=((e,t)=>{e.innerHTML=e.innerHTML+t,removeCursor(e)}),swapTypingText=((e,t)=>{e.innerHTML=t,removeCursor(e)}),type=((e,t,r)=>{setTimeout(()=>addTypingChar(e,t),r),setTimeout(()=>addCursor(e),r)}),backSpace=((e,t,r)=>(setTimeout(()=>swapTypingText(e,t),r),setTimeout(()=>addCursor(e),r),t.substring(0,t.length-1))),arrangeExecutionTime=((e,r)=>e+Math.floor(Math.random()*fenceSpeed(t.speed))+r),orchestrate=((e,t,r,o)=>{for(const r of t)type(e,r,o),o=arrangeExecutionTime(o,5);if(r){let r=5;for(o+=1e3;t;)t=backSpace(e,t,o),o=arrangeExecutionTime(o,r),r=Math.floor(.7*r);setTimeout(()=>swapTypingText(e,t)|addCursor(e),o)}return o}),playOrchestration=((e,r)=>{let o=0,n=!1;r.forEach((a,i)=>{n=i<r.length-1&&!t.loop||t.loop,o=orchestrate(e,a,n,o)+1e3}),t.loop?setTimeout(()=>playOrchestration(e,r),o):setTimeout(()=>animateCursor(e),o)}),document.querySelectorAll(e).forEach(e=>{let r=e.innerText;e.innerHTML="&lrm;",e.setAttribute("ketikin-seq","seq-"+Math.random().toString(36).substr(2)),playOrchestration(e,(t.texts||[r]).filter(e=>e))})};